<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="makina.css">
    <link rel="icon" type="image/jfif" href="lamborgini.jpg">
    <link rel="stylesheet" href="media.css">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <title>Choose a car</title>
</head>
<body>
    <div class="container">
        <img src="lambo.jfif" class="titulli" />
        <div class="tit">Car Rental Tirana Airport</div>
        <div class="pages">
            <div class="nje">
                <a href="index.html" class="tet">Home</a>
                <a href="cars.html" class="tet">Cars</a>
            </div>
        </div>
    </div>
    <div class="permb">
        <div class="text-cont">
            <div class="text-cont1">
                <div class="text-header">Set the dates</div>
                <div class="reminder">The Pick Up Location is right outside the Airport </div>
                <div class="select">Period of Rental</div>
                <center>
                <div class="cal" onclick="toggleCalendar()">
                    <p class="show" id="show">Dates</p>
                    <div class="border"></div>
                </div>
                <div class="calendar-container" id="calendarContainer">
                    <div class="calendar-header">
                        <div id="prevMonth">&lt;</div>
                        <div id="currentMonth"></div>
                        <div id="nextMonth">&gt;</div>
                    </div>
                    <div id="calendar"></div>
                </div>
                </center>
                <div class="select-cont">
                    <div class="select1">Pick up Time</div><div class="select2">Drop off Time</div>
                </div>
                <div class="cal-cont">
                <select class="cal1" id="pickUpTime">
                    <option>00:00</option>
                    <option>01:00</option>
                    <option>02:00</option>
                    <option>03:00</option>
                    <option>04:00</option>
                    <option>05:00</option>
                    <option>06:00</option>
                    <option>07:00</option>
                    <option>08:00</option>
                    <option>09:00</option>
                    <option>10:00</option>
                    <option>11:00</option>
                    <option>12:00</option>
                    <option>13:00</option>
                    <option>14:00</option>
                    <option>15:00</option>
                    <option>16:00</option>
                    <option>17:00</option>
                    <option>18:00</option>
                    <option>19:00</option>
                    <option>20:00</option>
                    <option>21:00</option>
                    <option>22:00</option>
                    <option>23:00</option>
                </select>
                <select class="cal1" id="dropOffTime">
                    <option>00:00</option>
                    <option>01:00</option>
                    <option>02:00</option>
                    <option>03:00</option>
                    <option>04:00</option>
                    <option>05:00</option>
                    <option>06:00</option>
                    <option>07:00</option>
                    <option>08:00</option>
                    <option>09:00</option>
                    <option>10:00</option>
                    <option>11:00</option>
                    <option>12:00</option>
                    <option>13:00</option>
                    <option>14:00</option>
                    <option>15:00</option>
                    <option>16:00</option>
                    <option>17:00</option>
                    <option>18:00</option>
                    <option>19:00</option>
                    <option>20:00</option>
                    <option>21:00</option>
                    <option>22:00</option>
                    <option>23:00</option>
                </select>
            </div>
        </div>
        <div class="vendi">
        <select style="background-color: transparent; border: solid;
        border-color: black;
        color: black;
        font-weight: bold;
        height: 30px;" id="location" onchange="updateTotalPrice()">
            <option value="Airport">Airport (Free)</option>
            <option value="Tirana">Tirana downtown (40 €)</option>
            <option value="Saranda">Saranda (200 €)</option>
        </select><p>Will you pass the border?
            <select style="margin-left: 15px; background-color: transparent;
        border: solid; font-weight: bold;" id="shteti" onchange="updateTotalPrice()"><option value="no">No</option><option value="yes">Yes</option></select></p>
        </div>
        <p style="text-align: center; margin-top: 0px;">Every border pass has a 50 € charge.</p>
        </div>
    <div class="makinat">
        <div class="mak-img">
            <img src="golf5.jfif" class="golfat">
            <div class="infot">
                <p class="emri-mak">Volkswagen Golf Mk5</p>
                <li>Manual</li>
                <li>5 Doors</li>
                <li>4L/100Km</li>
                <input type="hidden" id="selectedCar" name="selectedCar"><div class="bord"><p class="leku" id="golf5Price"
                onclick="showDiv('golf5')">Price: <strong>25</strong> €</p></div>
                <p class="porosit1">Order now</p>
            </div>
        </div>
    </div>
</div>
<div class="caka">
    <div class="makinat1">
            <div class="mak-img">
                <img src="toyota.jfif" class="golfat">
                <div class="infot1">
                    <p class="emri-mak">Toyota Auris</p>
                    <li>Manual</li>
                    <li>5 Doors</li>
                    <li>4L/100Km</li>
                    <input type="hidden" id="selectedCar" name="selectedCar"><div class="bord"><p class="leku" id="toyotaPrice"
                    onclick="showDiv('toyota')">Price: <strong>25</strong> €</p></div>
                    <p class="porosit">Order now</p>
                </div>
            </div>
            <div class="makinat1">
                <div class="mak-img1">
                    <img src="audia3.jfif" class="golfat">
                    <div class="infot">
                        <p class="emri-mak">Audi A3</p>
                        <li>Automatic</li>
                        <li>5 Doors</li>
                        <li>6L/100Km</li>
                        <input type="hidden" id="selectedCar" name="selectedCar"><div class="bord"><p class="leku" id="A3Price"
                        onclick="showDiv('A3')">Price: <strong>30</strong> €</p></div>
                        <p class="porosit">Order now</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="caka">
        <div class="makinat1">
            <div class="mak-img">
                <img src="audia4.jfif" class="golfat">
                <div class="infot1">
                    <p class="emri-mak">Audi A4</p>
                    <li>Automatic</li>
                    <li>5 Doors</li>
                    <li>8L/100Km</li>
                    <input type="hidden" id="selectedCar" name="selectedCar"><div class="bord"><p class="leku" id="A4Price"
                    onclick="showDiv('A4')">Price: <strong>50</strong> €</p></div>
                    <p class="porosit">Order now</p>
                </div>
            </div>
            <div class="makinat1">
                <div class="mak-img1">
                    <img src="golf+.jpg" class="golfat">
                    <div class="infot">
                        <p class="emri-mak">Golf Plus</p>
                        <li>Automatic</li>
                        <li>5 Doors</li>
                        <li>7L/100Km</li>
                        <input type="hidden" id="selectedCar" name="selectedCar"><div class="bord"><p class="leku" id="golf+Price"
                        onclick="showDiv('golf+')">Price: <strong>30</strong> €</p></div>
                        <p class="porosit">Order now</p>
                    </div>
                </div>
            </div>
        </div><br>
        <div class="makinat2">
            <div class="mak-img">
                <img src="golf7.jfif" class="golfat">
                <div class="infot">
                    <p class="emri-mak">Volkswagen Golf Mk6</p>
                    <li>Automatic</li>
                    <li>5 Doors</li>
                    <li>5L/100Km</li>
                    <input type="hidden" id="selectedCar" name="selectedCar"><div class="bord"><p class="leku" id="golf6Price"
                    onclick="showDiv('golf6')">Price: <strong>30</strong> €</p></div>
                    <p class="porosit1">Order now</p>
                </div>
            </div>
        </div>
    </div>
    <div id="popup" class="popup">
        <div class="popup-content">
            <h2 style="text-align: center; color: white;">Drivers Number</h2>
            <p style="text-align: center;">Additional driver : 3€ / day per extra person</p>
            <center><select style="width: 150px; background-color: transparent;
            border: solid;" id="additionalDrivers" onchange="updateTotalPrice()">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select></center>
            <h2 style="text-align: center; color: white;">Insurance</h2>
            <li class="je">With Normal Insurance you have to pay a 300 € fine for every damage on the car.</li>
            <li class="je">With 80% Casco you are mostly covered,
                you only pay 20% of the damage of the car.
                <strong style="font-weight: bold; color: rgb(4, 68, 4);">+10 €/day</strong></li>
            <li class="je">With 100% Casco gives you full coverage, every damage your car might cause but it doesn't cover damaged
                 tires and driving off-road. <strong style="font-weight: bold; color: rgb(4, 68, 4);">+20 €/day</strong></li>
            <div style="display: flex;
            justify-content: space-between;
            align-items: center;">
            <select class="siguracion" id="siguracion" name="siguracion" onchange="updateTotalPrice()">
                <option value="normal">Normal</option>
                <option value="80">80% Casco</option>
                <option value="100">100% Casco</option>
            </select>
            <button style="background-color: orange;
            font-weight: bold;
            width: 100px;
            height: 30px;
            border: solid;"
            onclick="change()" id="next">Next</button>
            </div>
        </div>
    </div>
    <div id="popup1" class="popup1">
        <h1>Total Price: <strong id="totalPrice" style="color:green;"></strong></h1>
            <h1 style="text-align: center; color: white; margin-top: 0px;">Order</h1>
            <input placeholder="Name" class="emri" id="emri" name="emri" onkeydown="Enter(event)">
            <input placeholder="Surname" class="mbiemri" id="mbiemri" name="mbiemri" onkeydown="Enter(event)">
            <input placeholder="Email" class="emaili" id="emaili" name="emaili" onkeydown="Enter(event)">
            <input placeholder="Notes" class="notes" id="notes" name="notes" onkeydown="Enter(event)">
            <button class="close" onclick="sendEmail()">Send email</button>
    </div>
    <a href="whatsapp://send?phone=+355676732491">
        <img src="whats.png" class="wapp">
    </a> 
    <div class="note" id="note"><p>You will receive an email to confirm the order</p>
    <p>Thank you for choosing us!</p>
    </div>
    <script>
        let startDate, endDate;
        let selectedCarPrice = 0;
        const calendarContainer = document.getElementById('calendarContainer');
        const showDatesElement = document.getElementById('show');
        const totalPriceElement = document.getElementById('totalPrice');
        const carPrices = {
            'golf5': 25,
            'toyota': 25,
            'A3': 30,
            'A4': 50,
            'golf+': 30,
            'golf6': 30
        };
        
        function toggleCalendar() {
            calendarContainer.style.display = calendarContainer.style.display === 'block' ? 'none' : 'block';
        }
        
        function updateTotalPrice() {
            const rentalDays = calculateRentalDays();
            const cascoSelection = document.getElementById('siguracion').value;
            const crossBorder = document.getElementById('shteti').value;
            const additionalDrivers = parseInt(document.getElementById('additionalDrivers').value, 10);
            const pickupLocation = document.getElementById('location').value;
            let cascoCost = 0;
            let borderCost = 0;
            let additionalDriverCost = 0;
            let locationCost = 0;
        
            if (cascoSelection === '80% Casco') {
                cascoCost = 10;
            } else if (cascoSelection === '100% Casco') {
                cascoCost = 20;
            }

            if (crossBorder === 'yes') {
                borderCost = 50;
            }

            if (additionalDrivers > 1) {
                additionalDriverCost = (additionalDrivers - 1) * 3 * rentalDays;
            }

            if (pickupLocation === 'Tirana') {
                locationCost = 40;
            } else if (pickupLocation === 'Saranda') {
                locationCost = 200;
            }
        
            let totalPrice = 0;
            if (rentalDays > 0) {
                let extraCharge = isJulyOrAugust(startDate, endDate) ? 20 : 0;
                totalPrice = rentalDays * (selectedCarPrice + cascoCost + extraCharge) + borderCost + additionalDriverCost + locationCost;
            }
            
            totalPriceElement.textContent = `${totalPrice} €`;
            return totalPrice;
        }

        function calculateRentalDays() {
            if (startDate && endDate) {
                const diffTime = Math.abs(endDate - startDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                return diffDays + 1; // Include both start and end date
            }
            return 0;
        }

        function isJulyOrAugust(start, end) {
            const july = 6; // Month index for July
            const august = 7; // Month index for August

            const isStartInJulyOrAugust = start.getMonth() === july || start.getMonth() === august;
            const isEndInJulyOrAugust = end.getMonth() === july || end.getMonth() === august;

            return isStartInJulyOrAugust || isEndInJulyOrAugust;
        }

        function updateCarPrices() {
            const extraCharge = isJulyOrAugust(startDate, endDate) ? 20 : 0;

            for (let car in carPrices) {
                const priceElement = document.getElementById(`${car}Price`);
                const basePrice = carPrices[car];
                const newPrice = basePrice + extraCharge;
                priceElement.innerHTML = `Price: <strong>${newPrice}</strong> €`;
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            let currentMonth = today.getMonth();
            let currentYear = today.getFullYear();
        
            const calendar = document.getElementById('calendar');
            const currentMonthElement = document.getElementById('currentMonth');
            const prevMonthElement = document.getElementById('prevMonth');
            const nextMonthElement = document.getElementById('nextMonth');
        
            function renderCalendar() {
                calendar.innerHTML = '';
                currentMonthElement.textContent = new Date(currentYear, currentMonth).toLocaleString('default', { month: 'long', year: 'numeric' });
        
                const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
                const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
        
                for (let i = 0; i < firstDayOfMonth; i++) {
                    calendar.appendChild(document.createElement('div'));
                }
        
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayElement = document.createElement('div');
                    dayElement.textContent = day;
                    dayElement.onclick = () => selectDate(new Date(currentYear, currentMonth, day));
                    calendar.appendChild(dayElement);
                }
            }
        
            function selectDate(date) {
                if (!startDate) {
                    startDate = date;
                    showDatesElement.textContent = `${startDate.toLocaleDateString()}`;
                } else if (!endDate) {
                    endDate = date;
                    showDatesElement.textContent += ` - ${endDate.toLocaleDateString()}`;
                    calendarContainer.style.display = 'none';
                    updateCarPrices(); // Update car prices when end date is selected
                    updateTotalPrice(); // Update total price after selecting the end date
                } else {
                    startDate = date;
                    endDate = null;
                    showDatesElement.textContent = `${startDate.toLocaleDateString()}`;
                }
            }
        
            prevMonthElement.onclick = () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar();
            };
        
            nextMonthElement.onclick = () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar();
            };
        
            renderCalendar();
        });
        
        function change(){
           document.getElementById('popup').classList.add('spost');
           document.getElementById('popup1').classList.add('duku');
           updateTotalPrice(); // Update total price when changing to the next step
        }
        
        function sendEmail() {
           const emerInput = document.getElementById('emri');
            const mbiemerInput = document.getElementById('mbiemri');
            const emailiInput = document.getElementById('emaili');
            const notesInput = document.getElementById('notes');
            const showDatesInput = document.getElementById('show');
            const siguracion = document.getElementById('siguracion').value;
            const shteti = document.getElementById('shteti').value;
            const additionalDrivers = document.getElementById('additionalDrivers').value;
            const selectedCar = document.getElementById('selectedCar').value;
            const pickupLocation = document.getElementById('location').value;
        
            const time1 = document.querySelector('.cal1:nth-child(1)').value;
            const time2 = document.querySelector('.cal1:nth-child(2)').value;
        
            const emri = emerInput.value;
            const mbiemri = mbiemerInput.value;
            const emaili = emailiInput.value;
            const notes = notesInput.value;
            const selectedDates = showDatesInput.textContent;
            const totalPrice = updateTotalPrice();
        
            const text = document.querySelector('.close');
            const content = document.querySelector('.popup');

            const note = document.getElementById('note');
            note.style.display = 'block';
            setTimeout(function() {
                note.style.display = 'none';
            }, 5000);
        
            if(text.innerHTML === 'Send email'){
                text.innerHTML = 'Thanks'
                text.classList.add('plus')
            } else{
                text.innerHTML = 'Send email'
                text.classList.remove('plus')
            }
        
            if(text.innerHTML == 'Thanks'){
                popup.classList.add('bye');
                popup1.classList.add('bye');
            } else if(text.innerHTML == 'Send email'){
                popup.classList.remove('bye');
                popup1.classList.remove('bye');
            }
                
            emailjs.init("N6ErUOxpRCQ6rHaao");
        
            var emailData = {
                to_email: "rentacartiranaairport1@gmail.com",
                from_name: emri + " " + mbiemri,
                message: "Emaili i porositesit nga: " + emaili +
                ".     " + "Notes: " + notes + ".        " + selectedDates + " " + time1 + " - " + time2 +
                "     Siguracioni: " + siguracion + "   " +  "Jasht shteti : " + shteti +
                 ".   Numri i Shoferave: " + additionalDrivers + ".    Lloji makines: " + selectedCar +".  Vendi:" + pickupLocation + ".    Cmimi Total: " + totalPrice + "€"
            };
        
            emailjs.send("service_pr32msp", "template_m9f5r4q", emailData)
            .then(function (response) {
                alert("Email sent successfully!", response);
            }, function (error){
                alert("Error while sending the email!", error);
            })
        }
        
        function showDiv(carPriceId) {
            var popup = document.getElementById("popup");
            var overlay = document.getElementById("overlay");
            popup.classList.add("show");
            if (popup.classList.add("show"));
        
            // Set the selected car price in the global variable
            selectedCarPrice = carPrices[carPriceId];
            document.getElementById('selectedCar').value = carPriceId;
        }
        </script>        
</body>
</html>

